{% extends "layout.html" %}
{% block body %}
<script>
    function changeDamage() {
        var damage = document.getElementById("damage_input").value;
        var health = {{ health }};
        document.getElementById("damage_p").innerHTML= damage;
        document.getElementById("health_p").innerHTML = (health - parseInt(damage)).toString();
        document.getElementById("health2").value = health - parseInt(damage);
    }
</script>
<h2>Shoot resuts:</h2>
<table class="fg2">
    <tr class="gris">
        <th class="fg2">{{ s1.name }}</th>
        <th>&nbsp;&nbsp;</th>
        <th class="fg2">{{ s2.name }}</th>
    </tr>
    <tr>
        <td class="fg2">dice({{ s_dice }}) + mod({{ s_mod }})</td>
        <td></td>
        <td class="fg2">dice({{ t_dice }}) + mod({{ t_mod }})</td>
    </tr>
</table>
{% if s_dice + s_mod > t_dice + t_mod %}
    <p><b>Hit!</b></p>
{% endif %}

{% if damage > 0 %}
    <ul>
        <li>
            <b>damage:</b> dice({{ s_dice }}) + mod({{ s_mod }}) + weapon_mod({{w_mod }}) - armour({{ armour }}) = 
            <input onchange="changeDamage()" type="number" id="damage_input" name="damage_input" min=0, max=50 maxlength="3" value={{ damage }}>
        </li>
        <li>
            <b>health:</b> {{ health }} - <span id="damage_p">{{ damage }}</span> = <span id="health_p"><b>{{ new_health }}</b></span>
        </li>
    </ul>
    
    {% if new_health == 0 %}
        <p style="color:red"><b>{{ s2.name }} KILLED!</b></p>
    {% endif %} 
{% else %}
    <ul>
        <li><b>No damage!</b></li>
    </ul>
{% endif %}
<form action="{{ url_for('apply_new_health') }}" method=post class=add-task>
    <input type="hidden" id="use_mini1" name="use_mini1" value="0">
    <input type="hidden" id="mini1" name="mini1" value={{ s1.rowid }}>
    <input type="hidden" id="health1" name="health1" value={{ s1.H }}>
    <input type="hidden" id="use_mini2" name="use_mini2" value="1">
    <input type="hidden" id="mini2" name="mini2" value={{ s2.rowid }}>
    <input type="hidden" id="health2" name="health2" value={{ new_health }}>
    <input type="submit" value="Apply">
</form>

{% endblock %}